(function(){"use strict";var e={3122:function(e,t,a){var i=a(4549),o=a.n(i),n=a(8935),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("transition",{attrs:{name:"transitionRouter"}},[a("router-view")],1)],1)},s=[],r=n["default"].extend({components:{}}),c=r,d=a(1001),u=(0,d.Z)(c,l,s,!1,null,null,null),h=u.exports,p=a(2809),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index"})},g=[],f={name:"indexView",components:{}},b=f,y=(0,d.Z)(b,m,g,!1,null,null,null),v=y.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-div"},[a("LoginComponent")],1)},x=[],k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-collection light-blue-clor",staticStyle:{"font-size":"28px"}}),e._v(" "),a("font",{staticClass:"light-blue-clor",staticStyle:{"font-size":"14px"}},[e._v("O(∩_∩)O")])],1),a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入账号","prefix-icon":"el-icon-user"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:"请输入密码","prefix-icon":"el-icon-key",type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.gotoRegister}},[e._v("没有账号?")]),a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary",size:"mini",round:"",disabled:e.loginBtnDisabled},on:{click:e.submitForm}},[e._v("登录"),a("i",{staticClass:"el-icon-arrow-right"})])],1)],1)],1)},_=[],C=(a(1703),a(6166)),$=a.n(C);const S={categoryGroup:"/article/categoryGroup",notesTable:"/article/notesTable",category:"/article/category",defaultLabels:"/article/defaultLabels",note:"/article/note",newNoteId:"/article/newNoteId",lockNote:"/article/notesTable/lock",unLockNote:"/article/notesTable/unlock",upload:"/article/upload",deleteImage:"/article/deleteTempImg",downloadInView:"/article/download/",downloadCategory:"/article/package/"},N={login:"/auth/loginProcess",refresh:"/auth/refresh",user:"/auth/user",users:"/auth/users",unconfirmedUsers:"/auth/unconfirmedUsers",accept:"/auth/accept",deny:"/auth/deny",invitationCode:"/auth/invitationCode",lockUser:"/auth/lock",unlockUser:"/auth/unlock",register:"/auth/register",mailCode:"/auth/mailCode",password:"/auth/password"},z={image:"/images/image"},T={api_article:S,api_auth:N,api_file:z,api_host:"http://wfnlrsuw.dnat.tech",file_host:"http://localhost:9002"};var D=T,L=a(7681);const P="metaData",E=e=>{e&&sessionStorage.setItem(P,L.DS.encode(JSON.stringify(e)))},I=()=>{const e=sessionStorage.getItem(P);return e?JSON.parse(L.DS.decode(e)):{}},F=(e,t)=>{const a=I();a[e]=t,E(a)},V=e=>{const t=I();E({...t,...e})},U=()=>{sessionStorage.removeItem(P)},B=e=>{const t=I();return t[e]},A={set:E,get:I,add:F,merge:V,getItem:B,clear:U};var M=A;const O=$().create({baseURL:D.api_host,timeout:5e3}),j=e=>(console.log(e),e.response?Promise.reject(e.response):Promise.reject({code:500,status:"INTERNAL_SERVER_ERROR",msg:"通信异常"}));O.interceptors.request.use((e=>{const t=M.get();return t.authorization&&(e.headers["Authorization"]=t.authorization),t.userId&&(e.headers["UserId"]=t.userId),e}),j),O.interceptors.response.use((e=>{const t=e.data;if(e.headers["md-file"]){const a=new Blob([t],{type:e.headers["content-type"]}),i=e.headers["content-disposition"].replace(/\w+; filename=(.*)/,"$1");let o=document.createElement("a"),n=window.URL.createObjectURL(a);return o.href=n,o.download=decodeURI(i),o.style.display="none",document.body.appendChild(o),o.click(),o.parentNode.removeChild(o),void window.URL.revokeObjectURL(n)}if(200!==t.code){let e=t.msg;return 500===t.code&&(e="系统内部错误",console.log(t.msg)),401===t.code&&(e="禁止未经认证的访问"),403===t.code&&(e="似乎没有登录或者登录信息异常"),408===t.code&&(e="认证信息过期了~需要重新登录"),401!==t.code&&403!==t.code||M.clear(),Promise.reject({code:t.code,status:t.status,msg:e})}if(e.headers.authorization&&e.headers.refreshtoken&&e.headers.userid){const t={authorization:e.headers.authorization,refreshToken:e.headers.refreshtoken,userId:e.headers.userid,loginMills:e.headers.loginmills,auth:e.headers.userauth};M.set(t)}return Promise.resolve(t)}),j);var R=O,Z=a(7421),W=a.n(Z),H={data(){var e=(e,t,a)=>{""===t?a(new Error("请输入密码")):a()};return{loginBtnDisabled:!1,loading:!1,form:{username:"",password:""},rules:{username:[{required:!0,message:"请输入账号",trigger:"change"}],password:[{validator:e,trigger:"change"}]}}},methods:{submitForm(){const e=this.form,t=()=>this;this.loading=!0,this.$refs["form"].validate((a=>{if(!a)return!1;{const a={...e};a.password=L.DS.encode(a.password),M.clear(),R.post(D.api_auth.login+"?"+W().stringify(a)).then((e=>{this.loginBtnDisabled=!0,this.$notify({title:"成功",message:"登录成功,即将跳转",type:"success",duration:700,onClose:()=>{M.merge({isLogin:!0,nickname:e.data,activeIndex:"2"}),t().$router.push({path:Qt.home,name:Qt.homeName,params:{nickname:e.data}})}})})).catch((e=>{M.clear();const t=1500;switch(e.code){case 401:this.$notify({title:"警告",message:e.msg,type:"warning",duration:t});break;case 407:this.$notify({title:"警告",message:"用户不存在",type:"warning",duration:t});break;case 410:this.$notify({title:"警告",message:"用户已被锁定",type:"warning",duration:t});break;case 411:this.$notify({title:"警告",message:"该用户正在等待审批确认中",type:"warning",duration:t});break;case 418:this.$notify({title:"警告",message:"密码不正确",type:"warning",duration:t});break;default:this.$notify.error({title:"错误",message:e.msg,duration:t});break}})).finally((()=>{t().loading=!1}))}}))},gotoRegister(){this.$router.push({name:Qt.registerName})}}},G=H,q=(0,d.Z)(G,k,_,!1,null,"ccf21a80",null),J=q.exports,Y=n["default"].extend({components:{LoginComponent:J}}),K=Y,Q=(0,d.Z)(K,w,x,!1,null,null,null),X=Q.exports,ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("HomeComponent")],1)},te=[],ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"home"}},[a("el-container",[a("el-header",{staticStyle:{padding:"0"}},[a("el-menu",{staticClass:"el-menu-demo",staticStyle:{"border-bottom-color":"#ffffff2e"},attrs:{"background-color":"#ffffff82","text-color":"#309286","default-active":e.activeIndex,mode:"horizontal"},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"1"}},[a("el-avatar",{attrs:{size:50}},[e._v(" "+e._s(e.nickname)+" ")])],1),a("el-menu-item",{attrs:{index:"2"}},[e._v("笔记本")]),a("el-menu-item",{attrs:{index:"3",disabled:""}},[e._v("消息中心")]),a("el-menu-item",{attrs:{index:"4",disabled:""}},[e._v("未完成")]),a("el-menu-item",{attrs:{index:"5",disabled:""}},[e._v("未完成")]),a("el-menu-item",{attrs:{index:"6",disabled:""}},[e._v("未完成")]),a("el-menu-item",{staticStyle:{float:"right"},attrs:{index:"9"},on:{click:e.logOut}},[a("i",{staticClass:"el-icon-switch-button"})])],1)],1),a("el-container",{staticStyle:{height:"calc(100vh - 60px)"}},[a("el-main",[a("transition",{attrs:{name:"transitionRouter"}},[a("router-view")],1)],1)],1)],1)],1)},ie=[],oe={data(){return{nickname:"",activeIndex:M.getItem("activeIndex")}},created(){let e=this.$route.params.nickname;e||(e=M.getItem("nickname")),this.nickname=e,"2"===this.activeIndex&&this.$router.push({path:Qt.home+"/panel"})},methods:{logOut(){this.$confirm("将会退出系统, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{M.clear(),window.clearInterval(window.refreshInt),this.$router.push({path:Qt.login})})).catch((e=>{console.log(e)}))},handleSelect(e,t){if("9"!==e)switch(this.activeIndex=e,M.add("activeIndex",e),e){case"1":this.$router.push({path:Qt.home+"/user"});break;case"2":this.$router.push({path:Qt.home+"/panel"});break;default:this.$router.push({path:Qt.home});break}}}},ne=oe,le=(0,d.Z)(ne,ae,ie,!1,null,"764700b7",null),se=le.exports,re=n["default"].extend({name:"HomeView",components:{HomeComponent:se}}),ce=re,de=(0,d.Z)(ce,ee,te,!1,null,null,null),ue=de.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user"},[a("UserComponent")],1)},pe=[],me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"userDetail"}},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{gutter:5,type:"flex"}},[a("el-col",{attrs:{span:13}},[a("el-card",{staticClass:"box-card",staticStyle:{"border-radius":"10px","background-color":"#ffffffad"}},[a("el-descriptions",{attrs:{title:"个人信息",column:2,border:""}},[a("template",{slot:"extra"},[a("el-button",{attrs:{type:"success",size:"small",plain:"",round:""},on:{click:e.showUpdateDialog}},[e._v("修改")]),a("el-button",{attrs:{type:"warning",size:"small",plain:"",round:""},on:{click:e.initResetDialog}},[e._v("重置密码")])],1),a("el-descriptions-item",{attrs:{label:"昵称","label-class-name":"my-label","content-class-name":"my-content"}},[e._v(e._s(e.nickName))]),a("el-descriptions-item",{attrs:{label:"邮箱","label-class-name":"my-label","content-class-name":"my-content"}},[e._v(e._s(e.mail))]),a("el-descriptions-item",{attrs:{label:"性别","label-class-name":"my-label","content-class-name":"my-content"}},[e._v(e._s(e.sex))])],2)],1),e.showUsers?a("el-card",{staticClass:"box-card",staticStyle:{"border-radius":"10px","background-color":"#ffffffad","margin-top":"5px",padding:"10px",height:"467px"}},[a("el-badge",{staticClass:"item",attrs:{value:e.registerNum,type:"warning"}},[a("el-button",{attrs:{size:"small",type:"warning",plain:""},on:{click:function(t){e.unconfirmVisible=!0}}},[e._v("审批")])],1),a("el-button",{staticStyle:{float:"left"},attrs:{size:"small",type:"success",plain:""},on:{click:e.generateInviteCode}},[e._v("生成邀请码")]),e._v(" 注册用户一览 "),a("div",{staticStyle:{float:"right",width:"220px",height:"14px","font-size":"13px","margin-bottom":"2px"},attrs:{id:"searchGroup"}},[a("el-input",{attrs:{id:"searchAccount",placeholder:"输入账号精确检索"},model:{value:e.searchAccount,callback:function(t){e.searchAccount=t},expression:"searchAccount"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchNormalAccount},slot:"append"})],1)],1),a("el-table",{staticStyle:{width:"100%","background-color":"#ffffffad"},attrs:{height:"384",data:e.userList}},[a("el-table-column",{attrs:{prop:"createTime",label:"创建日期",width:"129","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"account",label:"账号",width:"240"}}),a("el-table-column",{attrs:{prop:"mail",label:"邮箱"}}),a("el-table-column",{attrs:{label:"锁定/解锁",width:"150",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#ff6300","inactive-color":"#cfe9d0"},on:{change:function(a){return e.changeSwitch(t.row)}},model:{value:t.row.locked,callback:function(a){e.$set(t.row,"locked",a)},expression:"scope.row.locked"}}),e._v("  ")]}}],null,!1,4006023681)})],1),a("br"),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.pager.total,"current-page":e.pager.currentPage,"hide-on-single-page":e.hidePager,"page-size":7},on:{"current-change":e.currentPageChange}})],1):e._e()],1),a("el-col",{attrs:{span:11}},[a("el-calendar",{staticStyle:{"border-radius":"10px","background-color":"#ffffffad"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"修改个人信息",visible:e.updateDialog,"append-to-body":!0,width:"330px"},on:{"update:visible":function(t){e.updateDialog=t}}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("昵称")]),a("el-input",{attrs:{autocomplete:"off",placeholder:e.nickName,"prefix-icon":"el-icon-user"},model:{value:e.updNickName,callback:function(t){e.updNickName=t},expression:"updNickName"}}),a("el-divider",{attrs:{"content-position":"left"}},[e._v("邮箱")]),a("el-input",{attrs:{autocomplete:"off",placeholder:e.mail,"prefix-icon":"el-icon-message"},model:{value:e.updMail,callback:function(t){e.updMail=t},expression:"updMail"}}),a("el-divider",{attrs:{"content-position":"left"}},[e._v("性别")]),a("el-radio-group",{attrs:{size:"mini"},model:{value:e.updSexValue,callback:function(t){e.updSexValue=t},expression:"updSexValue"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("帅哥(^_−)☆")]),a("el-radio-button",{attrs:{label:"0"}},[e._v("美女(✪ω✪)")]),a("el-radio-button",{attrs:{label:""}},[e._v("未知(￣.￣)")])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",plain:"",round:""},on:{click:function(t){e.updateDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small",plain:"",round:""},on:{click:e.updateUserDetail}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"重置密码",visible:e.resetDialog,"append-to-body":!0,width:"330px"},on:{"update:visible":function(t){e.resetDialog=t}}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("邮箱验证码")]),a("el-input",{attrs:{autocomplete:"off",placeholder:"输入邮箱验证码,点右边→_→",disabled:e.mailCodeDisabled,"prefix-icon":"el-icon-message",maxlength:"6","show-word-limit":""},model:{value:e.mailCode,callback:function(t){e.mailCode=t},expression:"mailCode"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-s-promotion"},on:{click:e.sendMailCode},slot:"append"})],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("新密码")]),a("el-input",{attrs:{autocomplete:"off",placeholder:"输入新密码","prefix-icon":"el-icon-key",type:"password"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",plain:"",round:""},on:{click:function(t){e.resetDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small",plain:"",round:""},on:{click:e.resetPassword}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{width:"750px",title:"待确认审批的注册用户",visible:e.unconfirmVisible,"append-to-body":!0},on:{"update:visible":function(t){e.unconfirmVisible=t}}},[a("el-input",{staticStyle:{float:"left",width:"220px",height:"14px","font-size":"13px","margin-left":"10px"},attrs:{id:"unConfirmedAccount",placeholder:"输入账号检索"},model:{value:e.unConfirmedAccount,callback:function(t){e.unConfirmedAccount=t},expression:"unConfirmedAccount"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchUnConfirmedAccount},slot:"append"})],1),a("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.clearSearch}}),a("el-table",{attrs:{data:e.unconfirmedUsers,height:"520"}},[a("el-table-column",{attrs:{property:"createTime",label:"申请日期",width:"140"}}),a("el-table-column",{attrs:{property:"account",label:"账号",width:"200"}}),a("el-table-column",{attrs:{property:"mail",label:"邮箱"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-check",circle:"",plain:"",size:"mini",type:"success"},on:{click:function(a){return e.accept(t.row.id)}}}),a("el-popconfirm",{attrs:{"icon-color":"red",title:"拒绝这个用户的申请,确认吗?"},on:{confirm:function(a){return e.deny(t.row.id)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-close",circle:"",size:"mini"},slot:"reference"})],1)]}}])})],1)],1)],1)},ge=[],fe={name:"UserComponent",created(){const e=M.get();this.showUsers="1"===e.auth,this.loading=!0,R.get(D.api_auth.user).then((e=>{this.nickName=e.data.nickName,this.updNickName=e.data.nickName,this.mail=e.data.mail,this.updMail=e.data.mail,this.sex=e.data.sex,this.sexValue=e.data.sexValue,this.updSexValue=e.data.sexValue})).catch((e=>{this.$notify({title:"警告:获取用户数据失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1})),this.showUsers&&this.getUsersTable()},methods:{getUsersTable(){this.loading=!0,$().all([R.get(D.api_auth.unconfirmedUsers),R.get(D.api_auth.users)]).then($().spread(((e,t)=>{console.log(e),this.registerNum=e.data.length>0?e.data.length:"",this.unconfirmedUsers=e.data,this.cacheUsers=e.data,this.userList=t.data.userList??[],this.pager.total=t.data.total}))).catch((e=>{this.$notify({title:"警告:获取用户列表失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1,this.userList.length>0?this.hidePager=!1:this.hidePager=!0}))},currentPageChange(e){this.pager.currentPage=e,this.searchAccountTable()},searchNormalAccount(){this.searchAccountTable()},searchAccountTable(){this.loading=!0,R.get(D.api_auth.users+"?pageIndex="+this.pager.currentPage+"&searchAccount="+this.searchAccount).then((e=>{this.userList=e.data.userList,this.searchAccount?this.pager.total=0:this.pager.total=e.data.total})).catch((e=>{this.$notify({title:"警告:检索待审核用户失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))},clearSearch(){this.unConfirmedAccount="",this.unconfirmedUsers=this.cacheUsers},searchUnConfirmedAccount(){void 0!==this.unConfirmedAccount&&0!==this.unConfirmedAccount.trim().length?R.get(D.api_auth.unconfirmedUsers+"?unconfirmedAccount="+this.unConfirmedAccount).then((e=>{this.unconfirmedUsers=e.data})).catch((e=>{this.$notify({title:"警告:检索待审核用户失败",message:e.msg,type:"warning",duration:1300})})):this.$message({message:"请输入账号检索",type:"warning",duration:1300})},accept(e){this.loading=!0,R.post(D.api_auth.accept+"?id="+e).then((()=>{this.$notify({title:"该用户的注册申请已被接受",type:"success",duration:1300}),this.getUsersTable()})).catch((e=>{this.$notify({title:"警告:处理失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))},deny(e){this.loading=!0,R["delete"](D.api_auth.deny+"?id="+e).then((()=>{this.$notify({title:"该用户的注册申请已被拒绝",type:"success",duration:1300}),this.getUsersTable()})).catch((e=>{this.$notify({title:"警告:处理失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))},generateInviteCode(){this.loading=!0,R.get(D.api_auth.invitationCode).then((e=>{this.$alert("邀请码为: "+e.data,"邀请码60分钟后失效,关闭后不再显示",{confirmButtonText:"确定"})})).catch((e=>{this.$notify({title:"警告:生成失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))},changeSwitch(e){let t=e.locked;t?(e.locked=!1,this.$confirm("将会锁定此用户,锁定后其无法登录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,R.put(D.api_auth.lockUser,{id:e.id}).then((()=>{this.$notify({title:"已锁定该用户",type:"success",duration:1300}),e.locked=!0})).catch((e=>{this.$notify({title:"警告:锁定失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))})).catch((()=>{e.locked=!1}))):(e.locked=!0,this.$confirm("将会解锁此用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((()=>{this.loading=!0,R.put(D.api_auth.unlockUser,{id:e.id}).then((()=>{this.$notify({title:"已解锁该用户",type:"success",duration:1300}),e.locked=!1})).catch((e=>{this.$notify({title:"警告:锁定失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))})).catch((()=>{e.locked=!0})))},showUpdateDialog(){this.updNickName=this.nickName,this.updMail=this.mail,this.updSexValue=this.sexValue,this.updateDialog=!0},initResetDialog(){this.resetDialog=!0,this.mailCode="",this.newPassword=""},resetPassword(){this.mailCode&&0!==this.mailCode.trim().length?this.newPassword&&0!==this.newPassword.trim().length?(this.loading=!0,R.put(D.api_auth.password,{password:this.newPassword,code:this.mailCode}).then((()=>{this.$notify({title:"密码修改成功,下次登录时生效",type:"success",duration:1300}),this.mailCodeDisabled=!0,this.newPassword="",this.mailCode="",this.resetDialog=!1})).catch((e=>{this.$notify({title:"警告:密码修改失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))):this.$message({message:"新密码不能为空~",type:"warning",duration:1500}):this.$message({message:"验证码不能为空~请点击验证码发送按钮发送验证码",type:"warning",duration:1500})},sendMailCode(){this.loading=!0,R.post(D.api_auth.mailCode).then((()=>{this.$notify({title:"验证码已发送至"+this.mail+",请注意查收",type:"success",duration:1300}),this.mailCodeDisabled=!1})).catch((e=>{this.$notify({title:"警告:验证码发送失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))},updateUserDetail(){void 0!==this.updNickName&&0!==this.updNickName.trim().length?void 0!==this.updMail&&0!==this.updMail.trim().length?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(this.updMail)?this.updMail!==this.mail||this.updNickName!==this.nickName||this.updSexValue!==this.sexValue?(this.loading=!0,R.put(D.api_auth.user,{nickName:this.updNickName,mail:this.updMail,sexValue:this.updSexValue}).then((e=>{this.nickName=e.data.nickName,this.mail=e.data.mail,this.sex=e.data.sex,this.sexValue=e.data.sexValue,this.updateDialog=!1})).catch((e=>{this.$notify({title:"警告:更新用户详情失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))):this.updateDialog=!1:this.$message({message:"请输入合法的邮箱~",type:"error",duration:1500}):this.$message({message:"邮箱不能为空~",type:"error",duration:1500}):this.$message({message:"昵称不能为空~",type:"error",duration:1500})}},data(){return{updMail:"",updNickName:"",updSexValue:"",updateDialog:!1,resetDialog:!1,loading:!1,nickName:M.getItem("nickname"),mail:"",sex:"",sexValue:"",mailCode:"",newPassword:"",mailCodeDisabled:!0,date:new Date,userList:[],registerNum:"",showUsers:!1,unconfirmedUsers:[],unconfirmVisible:!1,unConfirmedAccount:"",cacheUsers:[],pager:{total:0,currentPage:1},hidePager:!1,searchAccount:""}}},be=fe,ye=(0,d.Z)(be,me,ge,!1,null,null,null),ve=ye.exports,we={name:"userView",components:{UserComponent:ve}},xe=we,ke=(0,d.Z)(xe,he,pe,!1,null,null,null),_e=ke.exports,Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"register-div"},[a("RegisterComponent")],1)},$e=[],Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"register"}},[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-document light-blue-clor",staticStyle:{"font-size":"30px"}}),e._v(" "),a("font",{staticClass:"light-blue-clor",staticStyle:{"font-size":"15px"}},[e._v("(●ˇ∀ˇ●)")])],1),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-position":e.labelPosition,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{attrs:{placeholder:"请输入账号",autocomplete:"off","prefix-icon":"el-icon-user"},model:{value:e.ruleForm.account,callback:function(t){e.$set(e.ruleForm,"account",t)},expression:"ruleForm.account"}})],1),a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入昵称",autocomplete:"off","prefix-icon":"el-icon-magic-stick"},model:{value:e.ruleForm.nickname,callback:function(t){e.$set(e.ruleForm,"nickname",t)},expression:"ruleForm.nickname"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-key",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"checkPassword"}},[a("el-input",{attrs:{type:"password",placeholder:"请确认密码","prefix-icon":"el-icon-unlock",autocomplete:"off"},model:{value:e.ruleForm.checkPassword,callback:function(t){e.$set(e.ruleForm,"checkPassword",t)},expression:"ruleForm.checkPassword"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"mail"}},[a("el-input",{attrs:{placeholder:"请输入邮箱(用于重置密码)","prefix-icon":"el-icon-message"},model:{value:e.ruleForm.mail,callback:function(t){e.$set(e.ruleForm,"mail",t)},expression:"ruleForm.mail"}})],1),a("el-form-item",{attrs:{label:"邀请码",prop:"invitationCode"}},[a("el-input",{attrs:{placeholder:"请输入邀请码(未开放注册时需要填写)","prefix-icon":"el-icon-share"},model:{value:e.ruleForm.invitationCode,callback:function(t){e.$set(e.ruleForm,"invitationCode",t)},expression:"ruleForm.invitationCode"}})],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{plain:"",size:"mini",round:""},on:{click:e.back}},[a("i",{staticClass:"el-icon-arrow-left"}),e._v("返回")]),a("el-popconfirm",{attrs:{title:"将会重置所有的项目, 是否继续?"},on:{confirm:e.reset}},[a("el-button",{attrs:{slot:"reference",size:"mini",round:""},slot:"reference"},[e._v("重置")])],1),a("el-button",{attrs:{type:"primary",size:"mini",round:"",disabled:e.disableBtn},on:{click:e.register}},[e._v("注册"),a("i",{staticClass:"el-icon-arrow-right"})])],1)],1)],1)},Ne=[],ze={data(){var e=(e,t,a)=>{""===t?a(new Error("请输入密码")):(""!==this.ruleForm.checkPassword&&this.$refs.ruleForm.validateField("checkPassword"),a())},t=(e,t,a)=>{""===t?a(new Error("请确认密码")):this.ruleForm.checkPassword!==this.ruleForm.password?a(new Error("密码输入不一致")):a()},a=(e,t,a)=>{if(""===this.ruleForm.mail)a(new Error("请输入邮箱"));else{let e=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;e.test(this.ruleForm.mail)?a():a(new Error("邮箱不合法"))}},i=(e,t,a)=>{""===this.ruleForm.account?a(new Error("请输入账号")):a()},o=(e,t,a)=>{""===this.ruleForm.nickname?a(new Error("请输入昵称")):a()};return{disableBtn:!1,loading:!1,labelPosition:"left",ruleForm:{account:"",nickname:"",password:"",checkPassword:"",mail:"",invitationCode:""},rules:{account:[{validator:i,trigger:"change"}],nickname:[{validator:o,trigger:"change"}],password:[{validator:e,trigger:"change"}],checkPassword:[{validator:t,trigger:"change"}],mail:[{validator:a,trigger:"change"}]}}},methods:{reset(){this.$notify.info({title:"消息",message:"已重置",duration:800}),this.$refs["ruleForm"].resetFields()},back(){this.$router.push({name:Qt.loginName})},register(){const e=()=>this;this.$refs["ruleForm"].validate((t=>{if(!t)return!1;this.loading=!0,this.disableBtn=!0,R.post(D.api_auth.register,{account:this.ruleForm.account,password:this.ruleForm.password,nickname:this.ruleForm.nickname,mail:this.ruleForm.mail,invitationCode:this.ruleForm.invitationCode}).then((()=>{this.$notify({title:"( •̀ .̫ •́ )✧",message:"注册申请已记录,等待管理员确认,即将回到登录界面",type:"success",duration:1200,onClose:()=>{e().$router.push({name:Qt.loginName})}})})).catch((e=>{this.$message({message:"注册失败:"+e.msg,type:"error",duration:1500}),this.disableBtn=!1})).finally((()=>{this.loading=!1}))}))}}},Te=ze,De=(0,d.Z)(Te,Se,Ne,!1,null,"41700cd5",null),Le=De.exports,Pe=n["default"].extend({components:{RegisterComponent:Le}}),Ee=Pe,Ie=(0,d.Z)(Ee,Ce,$e,!1,null,null,null),Fe=Ie.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"not-found"},[a("font",{staticStyle:{"font-size":"130px"}},[e._v("4 0 4")]),e._v("   "),a("font",{staticStyle:{"font-size":"22px"}},[e._v("NOT FOUND")]),a("br"),a("font",{staticStyle:{"font-size":"20px"}},[e._v("页面找不到了ಥ_ಥ")]),e._v("      "),a("el-button",{attrs:{type:"text"},on:{click:e.back}},[e._v("返回上一页")])],1)},Ue=[],Be={name:"404View",methods:{back(){this.$router.back()}}},Ae=Be,Me=(0,d.Z)(Ae,Ve,Ue,!1,null,"8203c8c6",null),Oe=Me.exports,je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("NoteListComponent")],1)},Re=[],Ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:5,type:"flex"}},[a("el-col",{attrs:{span:17}},[a("div",{staticStyle:{padding:"5px",border:"1px solid #ffffff00","border-radius":"10px",height:"653px","background-color":"#ffffff91","box-shadow":"#1ecdb987 1px 1px 5px 0px"}},[a("el-button",{staticStyle:{float:"right","margin-right":"15px","background-color":"#4cd1c4a1","border-color":"#4cd1c4a1"},attrs:{type:"primary",icon:"el-icon-plus",size:"medium",round:""},on:{click:e.createNote}},[e._v("新建")]),a("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{type:"warning",icon:"el-icon-upload",size:"medium",round:""},on:{click:e.uploadNote}},[e._v("上传")]),a("NotesTableComponent")],1)]),a("el-col",{attrs:{span:7}},[a("el-card",{staticClass:"box-card",staticStyle:{"border-radius":"8px","background-color":"#ffffff00",border:"1px solid #ffffff00","box-shadow":"#d7631ca6 1px 1px 5px 0px"}},[a("div",{attrs:{id:"tabs"}},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.tapClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"pie"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-data-analysis"}),e._v("分类图")]),a("el-scrollbar",[a("div",[a("CategoryPieComponent")],1)])],1),a("el-tab-pane",{attrs:{name:"manager"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-s-operation"}),e._v("管理")]),a("el-scrollbar",[a("div",[a("CategoryManagerComponent")],1)])],1)],1)],1)])],1)],1),a("el-dialog",{attrs:{title:"上传笔记",visible:e.uploadDialog,"append-to-body":!0,width:"400px"},on:{"update:visible":function(t){e.uploadDialog=t}}},[a("el-upload",{attrs:{drag:"",action:e.uploadUrl,multiple:!1,limit:1,headers:e.headers,"before-upload":e.uploadCheck,accept:".md, .txt","on-success":e.uploadSuccess}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传txt/md文件,且不超过1mb,上传成功后会进入编辑界面进行编辑。 ")])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.uploadDialog=!1}}},[e._v("取 消")])],1)],1)],1)},We=[],He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("div",{ref:"pie",staticClass:"echart",staticStyle:{width:"100%",height:"610px"}})])},Ge=[],qe=a(727),Je=JSON.parse('{"color":["#d87c7c","#a56ce7","#d7ab82","#46c92a","#61a0a8","#fe7e61","#e412ba","rgba(255,211,194,0.88)","#ec99c9","#7fcaec","#9f008a","#007e65","#72e9cb","#ffb380","#55fc00","#f7e897","#f24200"],"backgroundColor":"rgba(254,248,239,0.08)","textStyle":{},"title":{"textStyle":{"color":"#6d4747"},"subtextStyle":{"color":"#aaaaaa"}},"line":{"itemStyle":{"borderWidth":1},"lineStyle":{"width":2},"symbolSize":4,"symbol":"emptyCircle","smooth":false},"radar":{"itemStyle":{"borderWidth":1},"lineStyle":{"width":2},"symbolSize":4,"symbol":"emptyCircle","smooth":false},"bar":{"itemStyle":{"barBorderWidth":"0","barBorderColor":"#ccc"}},"pie":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"}},"scatter":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"}},"boxplot":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"}},"parallel":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"}},"sankey":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"}},"funnel":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"}},"gauge":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"}},"candlestick":{"itemStyle":{"color":"#c23531","color0":"#314656","borderColor":"#c23531","borderColor0":"#314656","borderWidth":1}},"graph":{"itemStyle":{"borderWidth":"0","borderColor":"#ccc"},"lineStyle":{"width":1,"color":"#aaaaaa"},"symbolSize":4,"symbol":"emptyCircle","smooth":false,"color":["#d87c7c","#a56ce7","#d7ab82","#46c92a","#61a0a8","#fe7e61","#e412ba","rgba(255,211,194,0.88)","#ec99c9","#7fcaec","#9f008a","#007e65","#72e9cb","#ffb380","#55fc00","#f7e897","#f24200"],"label":{"color":"#bbbbbb"}},"map":{"itemStyle":{"areaColor":"#eeeeee","borderColor":"#444444","borderWidth":0.5},"label":{"color":"#000000"},"emphasis":{"itemStyle":{"areaColor":"rgba(255,215,0,0.8)","borderColor":"#444444","borderWidth":1},"label":{"color":"rgb(100,0,0)"}}},"geo":{"itemStyle":{"areaColor":"#eeeeee","borderColor":"#444444","borderWidth":0.5},"label":{"color":"#000000"},"emphasis":{"itemStyle":{"areaColor":"rgba(255,215,0,0.8)","borderColor":"#444444","borderWidth":1},"label":{"color":"rgb(100,0,0)"}}},"categoryAxis":{"axisLine":{"show":true,"lineStyle":{"color":"#333"}},"axisTick":{"show":true,"lineStyle":{"color":"#333"}},"axisLabel":{"show":true,"color":"#333"},"splitLine":{"show":false,"lineStyle":{"color":["#ccc"]}},"splitArea":{"show":false,"areaStyle":{"color":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},"valueAxis":{"axisLine":{"show":true,"lineStyle":{"color":"#333"}},"axisTick":{"show":true,"lineStyle":{"color":"#333"}},"axisLabel":{"show":true,"color":"#333"},"splitLine":{"show":true,"lineStyle":{"color":["#ccc"]}},"splitArea":{"show":false,"areaStyle":{"color":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},"logAxis":{"axisLine":{"show":true,"lineStyle":{"color":"#333"}},"axisTick":{"show":true,"lineStyle":{"color":"#333"}},"axisLabel":{"show":true,"color":"#333"},"splitLine":{"show":true,"lineStyle":{"color":["#ccc"]}},"splitArea":{"show":false,"areaStyle":{"color":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},"timeAxis":{"axisLine":{"show":true,"lineStyle":{"color":"#333"}},"axisTick":{"show":true,"lineStyle":{"color":"#333"}},"axisLabel":{"show":true,"color":"#333"},"splitLine":{"show":true,"lineStyle":{"color":["#ccc"]}},"splitArea":{"show":false,"areaStyle":{"color":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},"toolbox":{"iconStyle":{"borderColor":"#999999"},"emphasis":{"iconStyle":{"borderColor":"#666666"}}},"legend":{"textStyle":{"color":"#333333"}},"tooltip":{"axisPointer":{"lineStyle":{"color":"#cccccc","width":1},"crossStyle":{"color":"#cccccc","width":1}}},"timeline":{"lineStyle":{"color":"#293c55","width":1},"itemStyle":{"color":"#293c55","borderWidth":1},"controlStyle":{"color":"#293c55","borderColor":"#293c55","borderWidth":0.5},"checkpointStyle":{"color":"#e43c59","borderColor":"#c23531"},"label":{"color":"#293c55"},"emphasis":{"itemStyle":{"color":"#a9334c"},"controlStyle":{"color":"#293c55","borderColor":"#293c55","borderWidth":0.5},"label":{"color":"#293c55"}}},"visualMap":{"color":["rgba(242,143,150,0.77)","#d88273","#f6efa6"]},"dataZoom":{"backgroundColor":"rgba(47,69,84,0)","dataBackgroundColor":"rgba(47,69,84,0.3)","fillerColor":"rgba(167,183,204,0.4)","handleColor":"#a7b7cc","handleSize":"100%","textStyle":{"color":"#333333"}},"markPoint":{"label":{"color":"#bbbbbb"},"emphasis":{"label":{"color":"#bbbbbb"}}}}'),Ye={name:"CategoryComponent",created(){qe.aW("vintage",Je),this.$EventBus.$on("pie_category_changed",(()=>{this.getData(this.refreshData)}))},mounted(){this.getData(this.initChart)},methods:{getData(e){R.get(D.api_article.categoryGroup).then((t=>{let a=t.data,i=[];a.forEach((e=>{i.push({name:e.categoryName,value:e.noteCount})})),e(i)})).catch((e=>{this.$notify({title:"警告",message:"分类图获取失败:"+e.msg,type:"warning",position:"bottom-right",duration:1500}),this.$refs.pie.innerHTML='<div style="position: relative;top:40%">分类图获取失败<div>',this.loading=!1}))},initChart(e){let t=qe.S1(this.$refs.pie,"vintage",{height:"610px"});this.options.series[0].data=e,t.setOption(this.options),window.onresize=()=>{console.log("window resized..."),t.resize()},this.loading=!1,this.chart=t},refreshData(e){this.options.series[0].data=e,this.chart.setOption(this.options)}},data(){return{chart:void 0,loading:!0,options:{tooltip:{trigger:"item"},legend:{type:"scroll",orient:"horizontal",bottom:5},series:[{name:"笔记分类",type:"pie",stillShowZeroSum:!1,label:{show:!1},radius:"60%",data:[]}]}}}},Ke=Ye,Qe=(0,d.Z)(Ke,He,Ge,!1,null,"5e639884",null),Xe=Qe.exports,et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.loading,expression:"loading",modifiers:{lock:!0}}],attrs:{id:"categoryManager"}},[a("el-table",{staticStyle:{"background-color":"#ffffff00"},attrs:{data:e.tableData,height:"572px"}},[a("el-table-column",{attrs:{prop:"categoryName",label:"分类名"}}),a("el-table-column",{attrs:{prop:"noteCount",label:"笔记数量","header-align":"center",align:"center",width:"80"}}),a("el-table-column",{attrs:{label:"操作",width:"106","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"top",width:"225"},on:{show:function(t){e.categoryNameMod=""}}},[a("el-input",{attrs:{autocomplete:"off",maxlength:"10","show-word-limit":"","prefix-icon":"el-icon-document-add",placeholder:t.row.categoryName},model:{value:e.categoryNameMod,callback:function(t){e.categoryNameMod=t},expression:"categoryNameMod"}}),a("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.closeEdit}},[e._v("取消")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.editCategory(t.row)}}},[e._v("确定")])],1),a("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-edit-outline",circle:"",size:"mini"},slot:"reference"})],1),a("el-popconfirm",{attrs:{"icon-color":"green","confirm-button-type":"success",title:"将会下载分类下的所有笔记,确认吗?"},on:{confirm:function(a){return e.downloadNotes(t.row)}}},[a("el-button",{attrs:{slot:"reference",type:"warning",icon:"el-icon-download",circle:"",size:"mini",disabled:0==t.row.noteCount},slot:"reference"})],1),a("el-popconfirm",{attrs:{"icon-color":"red","confirm-button-type":"danger",title:"将会删除这个分类,确认吗?"},on:{confirm:function(a){return e.deleteCategory(t.row)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-minus",circle:"",size:"mini",disabled:t.row.noteCount>0},slot:"reference"})],1)]}}])})],1),a("el-popover",{ref:"addCat",attrs:{placement:"top",width:"225"},on:{show:function(t){e.categoryName=""}},model:{value:e.dialogAddVisible,callback:function(t){e.dialogAddVisible=t},expression:"dialogAddVisible"}},[a("el-input",{attrs:{autocomplete:"off",maxlength:"10","show-word-limit":"","prefix-icon":"el-icon-document-add",placeholder:"在此输入类别名"},model:{value:e.categoryName,callback:function(t){e.categoryName=t},expression:"categoryName"}}),a("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.dialogAddVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addCategory}},[e._v("确定")])],1),a("el-button",{staticStyle:{"margin-top":"3px","background-color":"#00b6d37d","border-color":"#e7350085"},attrs:{slot:"reference",type:"primary",icon:"el-icon-plus",round:"",size:"medium"},slot:"reference"},[e._v("添加分类")])],1)],1)},tt=[],at={created(){this.getData(),this.$EventBus.$on("table_category_changed",(()=>{this.getData()}))},methods:{closeEdit(){document.body.click()},addCategory(){void 0!==this.categoryName&&""!==this.categoryName.trim()?this.tableData.length>25?this.$notify({title:"警告",message:"每个用户最大只能创建25个分类",position:"bottom-right",type:"warning",duration:1500}):(this.loading=!0,R.post(D.api_article.category,{categoryName:this.categoryName,categoryId:void 0}).then((e=>{this.$message({message:"创建完成~",type:"success",duration:1200}),this.dialogAddVisible=!1,this.getData(),this.$EventBus.$emit("pie_category_changed",void 0)})).catch((e=>{let t=e.msg;202===e.code&&(t="分类已经创建过了~考虑换个名字?"),this.$notify({title:"警告",message:t,type:"warning",position:"bottom-right",duration:1500})})).finally((()=>{this.loading=!1}))):this.$message({message:"你还没有输入任何东西",type:"warning",duration:1e3})},getData(){R.get(D.api_article.categoryGroup).then((e=>{this.tableData=e.data})).catch((e=>{this.$notify({title:"警告",message:"分类信息获取失败:"+e.msg,type:"warning",position:"bottom-right",duration:1500})}))},downloadNotes(e){this.loading=!0,R.post(D.api_article.downloadCategory+"/"+e.categoryId,void 0,{responseType:"blob"}).then((()=>{this.$message({message:"下载完成",type:"success"})})).catch((e=>{this.$message({message:"下载失败",type:"warning"})})).finally((()=>{this.loading=!1}))},deleteCategory(e){this.loading=!0,R["delete"](D.api_article.category+"?categoryId="+e.categoryId).then((t=>{this.$message({message:"已删除["+e.categoryName+"]~",duration:1500,type:"success"}),this.getData(),this.$EventBus.$emit("pie_category_changed",void 0)})).catch((e=>{console.log(e),this.$notify({title:"警告:删除分类失败",message:e.msg,type:"warning",position:"bottom-right",duration:1500})})).finally((()=>{this.loading=!1}))},editCategory(e){this.loading=!0,R.put(D.api_article.category,{categoryId:e.categoryId,categoryName:this.categoryNameMod}).then((t=>{this.$message({message:"已修改["+e.categoryName+"]为["+this.categoryNameMod+"]~",duration:1500,type:"success"}),this.getData(),this.closeEdit(),this.$EventBus.$emit("pie_category_changed",void 0)})).catch((e=>{console.log(e),this.$notify({title:"警告:修改分类失败",message:e.msg,type:"warning",position:"bottom-right",duration:1500})})).finally((()=>{this.loading=!1}))}},data(){return{loading:!1,categoryName:"",categoryNameMod:"",dialogAddVisible:!1,tableData:[]}}},it=at,ot=(0,d.Z)(it,et,tt,!1,null,null,null),nt=ot.exports,lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"tablePanel"}},[a("div",{attrs:{id:"searchGroup"}},[a("el-input",{staticStyle:{float:"left",width:"220px",height:"14px","font-size":"13px","margin-left":"10px"},attrs:{id:"searchCategory",placeholder:"输入分类检索"},model:{value:e.searchCategory,callback:function(t){e.searchCategory=t},expression:"searchCategory"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchByCategory},slot:"append"})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","background-color":"#ffffff00"},attrs:{data:e.noteList,height:"590px"}},[a("el-table-column",{attrs:{sortable:"",prop:"updateTime",label:"更新日期",width:"129","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"分类",width:"165"}}),a("el-table-column",{attrs:{prop:"title",label:"标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.labels.length>0?a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[e._l(t.row.labels,(function(t,i){return a("el-tag",{key:i,staticStyle:{"margin-right":"2px"},attrs:{type:"info"}},[e._v(e._s(t))])})),a("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.row.title))])],2):a("span",[e._v(e._s(t.row.title))])]}}])}),a("el-table-column",{attrs:{label:"锁定",width:"70","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#ffa501c7","inactive-color":"#ced1cf"},on:{change:function(a){return e.changeSwitch(t.row)}},model:{value:t.row.locked,callback:function(a){e.$set(t.row,"locked",a)},expression:"scope.row.locked"}}),e._v("  ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"108","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-reading",circle:"",size:"mini",type:"primary"},on:{click:function(a){return e.viewNote(t.row.id)}}}),a("el-popconfirm",{attrs:{"icon-color":"#40a491",title:"修改这条笔记,确认吗?"},on:{confirm:function(a){return e.editNote(t.row)}}},[a("el-button",{attrs:{slot:"reference",type:"success",icon:"el-icon-edit",circle:"",size:"mini"},slot:"reference"})],1),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",disabled:t.row.locked},on:{click:function(a){return e.deleteNote(t.row)}}})]}}])})],1),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.pager.total,"current-page":e.pager.currentPage,"hide-on-single-page":e.hidePager},on:{"current-change":e.currentPageChange}})],1)},st=[],rt={name:"NotesTableComponent",methods:{changeSwitch(e){e.locked?(this.loading=!0,R.put(D.api_article.lockNote,{id:e.id}).then((t=>{this.$message({message:"已锁定["+e.title+"] 锁定状态下的笔记不可被删除~",duration:1500,type:"success"})})).catch((t=>{console.log(t),e.locked=!1,this.$notify({title:"警告:锁定笔记失败",message:t.msg,type:"warning",position:"bottom-right",duration:1200})})).finally((()=>{this.loading=!1}))):(e.locked=!0,this.$confirm("解锁后该笔记就可以被删除了,是否确认?","提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((()=>{e.locked=!1,R.put(D.api_article.unLockNote,{id:e.id}).then((t=>{this.$message({message:"已解锁["+e.title+"] 解锁状态下的笔记可被删除~",duration:1500,type:"warning"})})).catch((t=>{console.log(t),e.locked=!0,this.$notify({title:"警告:解锁笔记失败",message:t.msg,type:"warning",position:"bottom-right",duration:1200})})).finally((()=>{this.loading=!1}))})))},deleteNote(e){this.$confirm("将会删除这条笔记,确认吗?","提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((()=>{this.loading=!0,R["delete"](D.api_article.note+"?id="+e.id).then((t=>{this.$message({message:"已删除["+e.title+"]~",duration:1500,type:"success"}),this.noteList.length>1||(this.pager.currentPage=this.pager.currentPage-1,this.pager.currentPage<=0&&(this.pager.currentPage=1)),this.getTableData(),this.$EventBus.$emit("pie_category_changed",void 0),this.$EventBus.$emit("table_category_changed",void 0)})).catch((e=>{console.log(e),this.$notify({title:"警告:删除笔记失败",message:e.msg,type:"warning",position:"bottom-right",duration:1200})})).finally((()=>{this.loading=!1}))})).catch((e=>{console.log(e)}))},editNote(e){this.$router.push({path:Qt.edit,name:Qt.editName,params:{id:e.id}})},viewNote(e){this.$router.push({path:Qt.view,name:Qt.viewName,params:{id:e}})},currentPageChange(e){this.pager.currentPage=e,this.getTableData()},searchByCategory(){this.pager.currentPage=1,this.getTableData()},getTableData(){this.loading=!0,R.post(D.api_article.notesTable,{pageIndex:this.pager.currentPage,searchCategory:this.searchCategory}).then((e=>{this.noteList=e.data.tableRows,this.pager.total=e.data.totalSize})).catch((e=>{console.log(e),this.$notify({title:"警告:获取笔记表格数据失败",message:e.msg,type:"warning",position:"bottom-right",duration:1200})})).finally((()=>{0===this.noteList.length&&(this.hidePager=!0),this.loading=!1}))}},created(){this.getTableData()},data(){return{searchCategory:"",hidePager:!1,loading:!1,pager:{total:0,currentPage:1},noteList:[]}}},ct=rt,dt=(0,d.Z)(ct,lt,st,!1,null,null,null),ut=dt.exports,ht={name:"NoteListComponent",components:{CategoryPieComponent:Xe,CategoryManagerComponent:nt,NotesTableComponent:ut},data(){return{uploadUrl:D.api_host+D.api_article.upload,activeName:"pie",uploadDialog:!1,headers:{Authorization:M.get().authorization,UserId:M.get().userId}}},methods:{tapClick(){this.$nextTick((()=>{window.onresize()}))},createNote(){this.$router.push({path:Qt["new"],name:Qt.newName})},uploadNote(){this.uploadDialog=!0},uploadCheck(e){const t=e.name.substring(e.name.lastIndexOf(".")+1);"md"===t||"txt"===t?e.size>1048576&&this.$message({message:"上传文件只能不能超过1m",type:"warning"}):this.$message({message:"上传文件只能是txt或者md格式",type:"warning"})},uploadSuccess(e,t,a){200!=e.code?this.$message({message:"上传文件失败",type:"warning"}):(this.$notify({title:"成功",message:"解析成功,即将进入编辑页面确认",type:"success",duration:1500}),setTimeout((()=>{this.$router.push({path:Qt["new"],name:Qt.newName,params:{content:e.data.markdown,title:e.data.title}})}),1e3))}}},pt=ht,mt=(0,d.Z)(pt,Ze,We,!1,null,null,null),gt=mt.exports,ft={name:"NoteListView",components:{NoteListComponent:gt}},bt=ft,yt=(0,d.Z)(bt,je,Re,!1,null,null,null),vt=yt.exports,wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"note"},[a("NotebookEditor")],1)},xt=[],kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:1,sm:1,md:1,lg:3,xl:4}},[a("div",[e._v(" ")])]),a("el-col",{attrs:{xs:22,sm:22,md:22,lg:18,xl:16}},[a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"editor"}},[a("el-button",{staticStyle:{float:"left"},attrs:{size:"small",round:"",icon:"el-icon-back",plain:"",type:"success"},on:{click:e.goBack}},[e._v("返回")]),a("br"),a("el-divider",{staticStyle:{padding:"0"}},[a("el-input",{staticStyle:{border:"none",width:"420px","background-color":"#ffffff00"},attrs:{id:"title","prefix-icon":"el-icon-set-up",type:"text",placeholder:"请在此输入标题~O(∩_∩)O~开始你的创作",maxlength:"20","show-word-limit":""},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("div",{staticStyle:{float:"left"},attrs:{id:"category"}},[a("el-select",{staticStyle:{display:"block",width:"240px"},attrs:{clearable:"",placeholder:"选择笔记类别"},on:{change:e.changeCategory},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}},e._l(e.groups,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.categories,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left","font-size":"17px"}},[a("i",{class:{"el-icon-s-order":"0"!==t.value},staticStyle:{color:"#008984"}}),e._v(e._s(t.label))])])})),1)})),1)],1),a("el-popover",{attrs:{placement:"bottom",width:"600",trigger:"click"}},[a("div",{staticStyle:{width:"100%"},attrs:{id:"labels"}},[a("el-select",{staticStyle:{display:"block"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"选择笔记的标签~最多5个标签~自定义标签最多10个字符~"},on:{change:e.changeLabels},model:{value:e.selectedLabels,callback:function(t){e.selectedLabels=t},expression:"selectedLabels"}},e._l(e.labels,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-button",{attrs:{slot:"reference",round:"",type:"primary",plain:""},slot:"reference"},[e._v("点我(｡･ω･｡)选择标签")])],1)],1),a("mavon-editor",{ref:"mdEditor",staticStyle:{"margin-top":"10px"},attrs:{fontSize:"18px",subfield:!1,toolbarsBackground:"#d8efe452",boxShadowStyle:"#0000008c 2px 2px 12px 0px",placeholder:"记录你的记录~",externalLink:e.externalLink,tabSize:4},on:{save:e.save,imgAdd:e.addImg,imgDel:e.delImg},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),a("EditorHelperComponent",{attrs:{visible:e.helpDialogVisible},on:{"update:visible":function(t){e.helpDialogVisible=t}}}),a("el-dialog",{attrs:{title:"新增类别",visible:e.dialogFormVisible,width:"350px","append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-input",{attrs:{autocomplete:"off",maxlength:"10","show-word-limit":"","prefix-icon":"el-icon-document-add",placeholder:"在此输入类别名"},model:{value:e.category_name,callback:function(t){e.category_name=t},expression:"category_name"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:e.addCategory}},[e._v("确 定")])],1)],1)],1)]),a("el-col",{attrs:{xs:1,sm:1,md:1,lg:3,xl:4}},[a("div",[e._v(" ")])])],1)],1)},_t=[],Ct=a(4408),$t=a.n(Ct),St=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"常用快捷键使用说明(注意:新建笔记时刷新会导致你的数据丢失)",visible:e.dialogTableVisible,"append-to-body":!0,width:"600px",top:"5vh"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{attrs:{data:e.gridData}},[a("el-table-column",{attrs:{property:"shortcut",label:"快捷键",width:"250"}}),a("el-table-column",{attrs:{property:"func",label:"功能"}})],1),a("br"),a("el-tag",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary"}},[e._v("本提示只在进入页面时显示")]),a("el-tag",{staticStyle:{float:"right"},attrs:{type:"warning"}},[e._v("多行空格在预览时只会显示一行")]),a("br")],1)],1)},Nt=[],zt={name:"EditorHelperComponent",props:{visible:Boolean},data(){return{dialogTableVisible:this.visible,gridData:[{shortcut:"F8",func:"开启/关闭导航"},{shortcut:"F9",func:"预览/编辑切换"},{shortcut:"F10",func:"开启/关闭全屏"},{shortcut:"F11",func:"开启/关闭阅读模式"},{shortcut:"F12",func:"单栏/双栏切换"},{shortcut:"CTRL + S",func:"保存"},{shortcut:"CTRL + D",func:"删除选中行"},{shortcut:"CTRL + Z | CTRL + Y",func:"上一步 | 下一步"},{shortcut:"SHIFT + TAB",func:"取消缩进"},{shortcut:"TAB",func:"缩进"},{shortcut:"CTRL + B",func:"粗体"},{shortcut:"CTRL + 1 ~ 6",func:"标题 1 ~ 6"}]}},watch:{visible:function(e){this.dialogTableVisible=e}}},Tt=zt,Dt=(0,d.Z)(Tt,St,Nt,!1,null,"50770d30",null),Lt=Dt.exports;n["default"].use($t());var Pt={components:{EditorHelperComponent:Lt},name:"NotebookEditor",created(){const e=this.$route.params.id;if(e)console.log("修改笔记~"),this.isUpdating=!0,this.id=e,this.loading=!0,R.get(D.api_article.note+"/?id="+e).then((e=>{const t=e.data;this.title=t.title,this.content=t.markdown,this.selectedCategory=t.categoryId,this.selectedLabels=t.labels})).catch((e=>{this.$notify({title:"警告:获取笔记数据失败",message:e.msg,type:"warning",duration:1500})})).finally((()=>{this.loading=!1}));else{console.log("新建笔记~"),this.content=this.$route.params.content||"",this.title=this.$route.params.title||"",this.isUpdating=!1;const e=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"#ffffffab"});setTimeout((()=>{e.close(),this.helpDialogVisible=!0}),1200),R.post(D.api_article.newNoteId).then((e=>{this.id=e.data})).catch((e=>{this.$notify({title:"错误:生成笔记id失败!后续处理不能正常进行!",message:e.msg,type:"error",duration:1700})}))}$().all([R.get(D.api_article.category),R.get(D.api_article.defaultLabels)]).then($().spread(((e,t)=>{let a=e.data;a.forEach((e=>{this.groups[1].categories.push({label:e.categoryName,value:e.categoryId})})),this.labels=t.data}))).catch((e=>{this.$notify({title:"警告:获取必要数据失败",message:e.msg,type:"warning",duration:1500})}))},methods:{goBack(){this.$confirm("将会返回控制台页面，所有未保存操作将会丢失，是否确认?","提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((()=>{this.$router.push({path:Qt.home,name:Qt.homeName})}))},refreshCategory(){R.get(D.api_article.category).then((e=>{let t=e.data,a=[];t.forEach((e=>{a.push({label:e.categoryName,value:e.categoryId})})),this.groups[1].categories=a})).catch((e=>{this.$notify({title:"警告:刷新类别数据失败",message:e.msg,type:"warning",duration:1500})}))},addCategory(){void 0!==this.category_name&&""!==this.category_name.trim()?this.groups[1].categories.length>25?this.$notify({title:"警告",message:"每个用户最大只能创建25个分类",type:"warning",duration:1500}):(this.loading=!0,R.post(D.api_article.category,{categoryName:this.category_name,categoryId:void 0}).then((e=>{this.$message({message:"创建完成,现在可以使用了~",type:"success",duration:1e3}),this.dialogFormVisible=!1,this.groups[1].categories.push({value:e.data,label:this.category_name}),this.selectedCategory=e.data})).catch((e=>{let t=e.msg;202===e.code&&(t="分类已经创建过了,这里帮你重新加载了~",this.refreshCategory()),this.$notify({title:"警告",message:t,type:"warning",duration:1500})})).finally((()=>{this.loading=!1}))):this.$message({message:"你还没有输入任何东西",type:"warning",duration:1e3})},changeLabels(e){const t=e.length-1;if(t>-1&&-1===this.labels.indexOf(e[t])&&e[t].length>10)return this.$notify({title:"警告",message:"自定义标签最大10个字",type:"warning",duration:1500}),void(this.selectedLabels=e.slice(0,t));e.length>5&&(this.$notify({title:"警告",message:"最多只能指定5个标签",type:"warning",duration:1500}),this.selectedLabels=e.slice(0,5))},changeCategory(e){"0"===e&&(this.selectedCategory="",this.dialogFormVisible=!0,this.category_name="")},save(){if(void 0!==this.id&&0!==this.id.trim().length||this.$message({message:"笔记数据不整合~尝试重新进入页面",type:"error",duration:1500}),void 0===this.title||0===this.title.trim().length)return void this.$message({message:"请输入标题~",type:"warning",duration:1500});if(void 0===this.selectedCategory||0===this.selectedCategory.trim().length)return void this.$message({message:"请选择分类~",type:"warning",duration:1500});if(void 0===this.content||0===this.content.trim().length)return void this.$message({message:"必须要写点什么才能保存~",type:"warning",duration:1500});const e={id:this.id,title:this.title,markdown:this.content,categoryId:this.selectedCategory,labels:this.selectedLabels};this.loading=!0;const t=()=>{this.$notify({title:"笔记已提交",message:"笔记已被妥善保存了~",type:"success",duration:1500}),this.isUpdating?this.$router.push({path:Qt.edit,name:Qt.editName,params:{id:this.id}}):setTimeout((()=>{this.$router.push({path:Qt.home,name:Qt.homeName})}),900)};this.isUpdating?R.put(D.api_article.note,e).then(t).catch((e=>{let t=e.msg;201===e.code&&(t="似乎受到了服务器的抗拒~再提交一次试试~"),this.$notify({title:"警告",message:t,type:"warning",duration:1500})})).finally((()=>{this.loading=!1})):R.post(D.api_article.note,e).then(t).catch((e=>{let t=e.msg;201===e.code&&(t="似乎受到了服务器的抗拒~再提交一次试试~"),this.$notify({title:"警告",message:t,type:"warning",duration:1500})})).finally((()=>{this.loading=!1}))},addImg(e,t){},delImg(e){}},data(){return{isUpdating:!1,id:"",loading:!1,category_name:"",dialogFormVisible:!1,helpDialogVisible:!1,title:"",content:"",selectedLabels:[],labels:[],groups:[{categories:[{value:"0",label:"+ 新建 + "}]},{label:"已有类别",categories:[]}],selectedCategory:"",externalLink:{markdown_css:function(){return"/static/md/github-markdown.min.css"},hljs_js:function(){return"/static/md/highlight.min.js"},hljs_css:function(e){return"/static/md/styles/"+e+".min.css"},hljs_lang:function(e){return"/static/md/languages/"+e+".min.js"},katex_css:function(){return"/static/md/katex.min.css"},katex_js:function(){return"/static/md/katex.min.js"}},toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!1,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}}},Et=Pt,It=(0,d.Z)(Et,kt,_t,!1,null,null,null),Ft=It.exports,Vt=n["default"].extend({name:"NotebookView",components:{NotebookEditor:Ft}}),Ut=Vt,Bt=(0,d.Z)(Ut,wt,xt,!1,null,null,null),At=Bt.exports,Mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"note_viewer"},[a("NoteViewerComponent")],1)},Ot=[],jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:5,sm:5,md:5,lg:6,xl:6}},[a("div",[e._v(" ")])]),a("el-col",{attrs:{xs:14,sm:14,md:14,lg:12,xl:12}},[a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"viewer"}},[a("el-button",{staticStyle:{float:"left"},attrs:{size:"small",round:"",icon:"el-icon-back",plain:"",type:"success"},on:{click:e.goBack}},[e._v("返回")]),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small",round:"",plain:"",type:"primary"},on:{click:e.goEdit}},[e._v("修改 "),a("i",{staticClass:"el-icon-right"})]),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"warning",round:"",icon:"el-icon-download",plain:""},on:{click:e.download}},[e._v("下载")]),a("br"),a("el-divider",[a("font",{staticStyle:{color:"#34bd0078","font-weight":"600","font-size":"18px"}},[e._v(e._s(e.title))])],1),a("el-row",{attrs:{type:"flex",justify:"start"}},[a("div",[0===e.labels.length?a("el-tag",{staticStyle:{float:"left"},attrs:{size:"mini",type:"info"}},[e._v("无标签")]):e._e(),e._l(e.labels,(function(t,i){return a("el-tag",{key:i,staticStyle:{float:"left","margin-right":"2px"},attrs:{size:"mini"}},[e._v(e._s(t))])}))],2)]),a("mavon-editor",{staticStyle:{"margin-top":"5px"},attrs:{defaultOpen:"preview",subfield:!1,toolbarsFlag:!1,editable:!1,shortCut:!1,toolbarsBackground:"#d8efe452",boxShadowStyle:"#0000008c 2px 2px 12px 0px",previewBackground:"#cce9e24d",externalLink:e.externalLink},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)]),a("el-col",{attrs:{xs:5,sm:5,md:5,lg:6,xl:6}},[a("div",[e._v(" ")])])],1)],1)},Rt=[],Zt={name:"NoteViewerComponent",created(){this.id=this.$route.params.id,this.loading=!0,R.get(D.api_article.note+"/?id="+this.id).then((e=>{const t=e.data;this.title=t.title,this.content=t.markdown,this.categoryName=t.categoryName,this.labels=t.labels})).catch((e=>{this.$notify({title:"警告:获取笔记数据失败",message:e.msg,type:"warning",duration:1300})})).finally((()=>{this.loading=!1}))},methods:{goBack(){this.$router.push({path:Qt.home,name:Qt.homeName})},download(){this.loading=!0,R.post(D.api_article.downloadInView+"/"+this.id,void 0,{responseType:"blob"}).then((()=>{this.$message({message:"下载完成",type:"success"})})).catch((e=>{this.$message({message:"下载失败",type:"warning"})})).finally((()=>{this.loading=!1}))},goEdit(){this.$confirm("将会进入编辑界面, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$router.push({path:Qt.edit,name:Qt.editName,params:{id:this.id}})})).catch((e=>{console.log(e)}))}},data(){return{id:"",labels:[],categoryName:"",title:"",content:"",loading:!1,externalLink:{markdown_css:function(){return"/static/md/github-markdown.min.css"},hljs_js:function(){return"/static/md/highlight.min.js"},katex_css:function(){return"/static/md/katex.min.css"},katex_js:function(){return"/static/md/katex.min.js"}}}}},Wt=Zt,Ht=(0,d.Z)(Wt,jt,Rt,!1,null,null,null),Gt=Ht.exports,qt=n["default"].extend({name:"NotebookInfoView",components:{NoteViewerComponent:Gt}}),Jt=qt,Yt=(0,d.Z)(Jt,Mt,Ot,!1,null,null,null),Kt=Yt.exports;n["default"].use(p.Z);const Qt={any:"*",root:"/",notebook:"/notebook",login:"/notebook/login",loginName:"login",register:"/notebook/register",registerName:"register",index:"/notebook/index",home:"/notebook/main",homeName:"main",new:"/notebook/new",newName:"new",edit:"/notebook/edit/:id",editName:"edit",view:"/notebook/view/:id",viewName:"view",user:"/notebook/user",userName:"user"},Xt=[{path:Qt.root,redirect:Qt.login},{path:Qt.register,name:Qt.registerName,component:Fe},{path:Qt.login,name:Qt.loginName,component:X},{path:Qt.index,name:"index",component:v},{path:Qt.home,name:Qt.homeName,component:ue,children:[{path:"panel",component:vt},{path:"user",component:_e}]},{path:Qt.new,name:Qt.newName,component:At},{path:Qt.edit,name:Qt.editName,component:At},{path:Qt.view,name:Qt.viewName,component:Kt},{path:Qt.any,component:Oe}],ea=new p.Z({mode:"history",base:"/",routes:Xt});ea.beforeEach(((e,t,a)=>{if(e.path===Qt.login||e.path===Qt.register)a();else{const t=M.get();t.isLogin?(void 0===window.refreshInt&&(ta(),window.refreshInt=window.setInterval((()=>{ta()}),3e5)),e.path===Qt.notebook||e.path===Qt.notebook+"/"?a({path:Qt.home}):a()):a({path:Qt.login})}}));const ta=()=>{const e=M.get(),t=parseInt(e.loginMills,10);Date.now()-t>12e5&&R.post(D.api_auth.refresh,void 0,{headers:{RefreshToken:e.refreshToken}}).then((e=>{M.add("loginMills",e.data.LoginMills),M.add("authorization",e.data.Authorization)})).catch((e=>{console.log("自动续约异常",e)}))};var aa=ea,ia=a(4665);n["default"].use(ia.ZP);var oa=new ia.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}});n["default"].config.productionTip=!1,n["default"].use(o()),n["default"].prototype.$EventBus=new n["default"],new n["default"]({router:aa,store:oa,render:e=>e(h)}).$mount("#app")}},t={};function a(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,i,o,n){if(!i){var l=1/0;for(d=0;d<e.length;d++){i=e[d][0],o=e[d][1],n=e[d][2];for(var s=!0,r=0;r<i.length;r++)(!1&n||l>=n)&&Object.keys(a.O).every((function(e){return a.O[e](i[r])}))?i.splice(r--,1):(s=!1,n<l&&(l=n));if(s){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[i,o,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var o,n,l=i[0],s=i[1],r=i[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(r)var d=r(a)}for(t&&t(i);c<l.length;c++)n=l[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},i=self["webpackChunknotebook_app"]=self["webpackChunknotebook_app"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(3122)}));i=a.O(i)})();
//# sourceMappingURL=app.8d52df05.js.map